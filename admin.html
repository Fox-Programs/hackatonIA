<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>Admin Quiz</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>

<body>
    <main>
        <h1>üéõÔ∏è Panneau de Contr√¥le Quiz</h1>

        <!-- QR code ici -->
        <canvas id="qrcode"></canvas>

        <button onclick="startQuiz()">D√©marrer le Quiz</button>
        <p>Question en cours : <span id="current-question">Aucune</span></p>

        <!-- Score moyen -->
        <h2>Score moyen des participants : <span id="average-score">0</span></h2>
    </main>

    <!-- Fichiers JS n√©cessaires -->
    <script src="data.js"></script>
    <script src="quiz.js"></script>

    <script>
        // Affichage du QR code
        QRCode.toCanvas(
            document.getElementById('qrcode'),
            'https://fox-programs.github.io/hackatonIA/',
            function (error) {
                if (error) console.error(error);
                else console.log("QR code g√©n√©r√© !");
            }
        );

        // Suivi de la progression du quiz
        const currentQ = document.getElementById('current-question');

        listenToChanges((index) => {
            if (index === -1) {
                currentQ.textContent = "Termin√© ‚úÖ";
            } else {
                currentQ.textContent = `${index + 1} / ${quiz.length}`;
            }
        });

        // Calcul du score moyen
        function updateAverageScore() {
            const scores = JSON.parse(localStorage.getItem("scores") || "[]");
            if (scores.length > 0) {
                const sum = scores.reduce((acc, score) => acc + score, 0);
                const average = sum / scores.length;
                document.getElementById('average-score').textContent = average.toFixed(2);
            }
        }

        // Appeler la fonction pour mettre √† jour le score moyen
        setInterval(updateAverageScore, 1000);

        // Fonction pour d√©marrer le quiz
        function startQuiz() {
            // Signale que le quiz a commenc√© en stockant une valeur dans localStorage
            localStorage.setItem("quiz_started", "true");
        }
    </script>
</body>

</html>
